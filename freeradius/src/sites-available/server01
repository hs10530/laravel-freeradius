server server01 {
listen {
	ipaddr = *
	type = auth
	port = 1814
	limit {
	      max_connections = 16
	      lifetime = 0
	      idle_timeout = 30
	}
}
listen {
	ipaddr = *
	port = 1815
	type = acct

	limit {
	}
}

authorize {
	filter_username
	preprocess
	sql

	# Uncomment the next three lines if you want to use SQL group checking
	#if (SQL-Group != "" && SQL-Group != "" && SQL-Group != "") {
	#	reject
	#}
	expiration
	logintime
	pap
}


authenticate {
	Auth-Type PAP {
		pap
	}
	eap
}

preacct {
	preprocess
	acct_unique
	suffix
}

accounting {
	#detail
	unix
	sql
	exec
	attr_filter.accounting_response
}

session {
	sql
}
post-auth {
	update {
		&reply: += &session-state:
	}

	exec

	Post-Auth-Type REJECT {
		attr_filter.access_reject
	}
}


post-proxy {
	eap
}
}
